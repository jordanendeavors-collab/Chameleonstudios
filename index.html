<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Chameleon Generator‚Ñ¢ | Sketch ‚Üí Art Magic</title>
    <meta name="description" content="Draw a simple sketch, watch it transform into 4 stunning art styles. Comic, Realistic, Postcard, Stencil & more.">
    <link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>ü¶é</text></svg>">
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Space+Grotesk:wght@400;500;600;700&family=Crimson+Pro:ital,wght@0,400;0,600;1,400&display=swap');
        
        :root {
            --bg: #030306;
            --surface: #0a0a0f;
            --card: #101018;
            --elevated: #181822;
            --border: rgba(255,255,255,0.05);
            --border-hover: rgba(255,255,255,0.12);
            --text: #f5f5f7;
            --text-dim: #9898a8;
            --text-muted: #5c5c6c;
            
            --accent: #00d4aa;
            --accent-glow: rgba(0,212,170,0.4);
            --purple: #9c5cff;
            --pink: #ff5c9c;
            --orange: #ff8c42;
            --blue: #4c9cff;
            --yellow: #ffcc00;
            
            --comic: #ff3366;
            --realistic: #00cc88;
            --postcard: #ffaa33;
            --stencil: #6644ff;
            --watercolor: #44aaff;
            --funky: #ff44aa;
            
            --radius: 16px;
            --radius-lg: 24px;
        }
        
        * { margin: 0; padding: 0; box-sizing: border-box; }
        
        body {
            font-family: 'Space Grotesk', -apple-system, sans-serif;
            background: var(--bg);
            color: var(--text);
            min-height: 100vh;
            line-height: 1.5;
            overflow-x: hidden;
        }
        
        /* Animations */
        @keyframes glow { 0%,100%{filter:drop-shadow(0 0 20px var(--accent-glow))} 50%{filter:drop-shadow(0 0 40px var(--accent-glow))} }
        @keyframes pulse { 0%,100%{transform:scale(1)} 50%{transform:scale(1.05)} }
        @keyframes shimmer { 0%{background-position:200% 0} 100%{background-position:-200% 0} }
        @keyframes float { 0%,100%{transform:translateY(0)} 50%{transform:translateY(-12px)} }
        @keyframes spin { to{transform:rotate(360deg)} }
        @keyframes reveal { from{opacity:0;transform:translateY(30px) scale(0.95)} to{opacity:1;transform:translateY(0) scale(1)} }
        @keyframes strokeDraw { from{stroke-dashoffset:1000} to{stroke-dashoffset:0} }
        @keyframes colorCycle { 0%{filter:hue-rotate(0deg)} 100%{filter:hue-rotate(360deg)} }
        @keyframes magicTransform { 
            0%{transform:scale(1) rotate(0deg);filter:blur(0)} 
            25%{transform:scale(0.9) rotate(-2deg);filter:blur(4px)} 
            50%{transform:scale(1.1) rotate(2deg);filter:blur(8px) brightness(1.5)} 
            75%{transform:scale(0.95) rotate(-1deg);filter:blur(4px)} 
            100%{transform:scale(1) rotate(0deg);filter:blur(0)} 
        }
        
        /* Header */
        header {
            position: sticky;
            top: 0;
            z-index: 100;
            background: rgba(3,3,6,0.9);
            backdrop-filter: blur(30px);
            border-bottom: 1px solid var(--border);
            padding: 16px 24px;
        }
        .header-inner {
            max-width: 1800px;
            margin: 0 auto;
            display: flex;
            align-items: center;
            justify-content: space-between;
            gap: 20px;
            flex-wrap: wrap;
        }
        .logo {
            display: flex;
            align-items: center;
            gap: 14px;
            cursor: pointer;
        }
        .logo-icon {
            width: 56px;
            height: 56px;
            border-radius: 16px;
            background: linear-gradient(135deg, var(--accent), var(--purple));
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 30px;
            animation: glow 3s ease-in-out infinite;
        }
        .logo-text h1 {
            font-size: 26px;
            font-weight: 700;
            background: linear-gradient(135deg, var(--accent), var(--purple));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }
        .logo-text p {
            font-size: 12px;
            color: var(--text-muted);
            letter-spacing: 2px;
            text-transform: uppercase;
        }
        
        .nav-pills {
            display: flex;
            gap: 8px;
            background: var(--surface);
            padding: 6px;
            border-radius: 14px;
            border: 1px solid var(--border);
        }
        .nav-pill {
            padding: 12px 20px;
            border: none;
            background: transparent;
            color: var(--text-dim);
            font-size: 14px;
            font-weight: 600;
            cursor: pointer;
            border-radius: 10px;
            transition: all 0.3s;
        }
        .nav-pill:hover { color: var(--text); background: var(--card); }
        .nav-pill.active { background: var(--accent); color: #000; }
        
        /* Main */
        main {
            max-width: 1800px;
            margin: 0 auto;
            padding: 32px 24px 80px;
        }
        
        .section { display: none; }
        .section.active { display: block; animation: reveal 0.5s ease; }
        
        /* Hero */
        .hero {
            text-align: center;
            margin-bottom: 48px;
            position: relative;
        }
        .hero::before {
            content: '';
            position: absolute;
            top: -100px;
            left: 50%;
            transform: translateX(-50%);
            width: 600px;
            height: 600px;
            background: radial-gradient(circle, var(--accent-glow) 0%, transparent 70%);
            opacity: 0.3;
            pointer-events: none;
        }
        .hero-badge {
            display: inline-flex;
            align-items: center;
            gap: 10px;
            padding: 12px 24px;
            background: var(--card);
            border: 1px solid var(--accent);
            border-radius: 50px;
            font-size: 14px;
            font-weight: 600;
            color: var(--accent);
            margin-bottom: 24px;
        }
        .hero-badge .dot {
            width: 8px;
            height: 8px;
            background: var(--accent);
            border-radius: 50%;
            animation: pulse 2s ease infinite;
        }
        .hero h2 {
            font-size: clamp(32px, 6vw, 56px);
            font-weight: 700;
            line-height: 1.1;
            margin-bottom: 16px;
        }
        .hero h2 span {
            background: linear-gradient(135deg, var(--accent), var(--purple), var(--pink));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }
        .hero p {
            font-size: 18px;
            color: var(--text-dim);
            max-width: 600px;
            margin: 0 auto;
        }
        
        /* App Grid */
        .app-grid {
            display: grid;
            grid-template-columns: 1fr;
            gap: 32px;
        }
        @media (min-width: 1200px) {
            .app-grid { grid-template-columns: 500px 1fr; }
        }
        
        /* Panels */
        .panel {
            background: var(--card);
            border: 1px solid var(--border);
            border-radius: var(--radius-lg);
            overflow: hidden;
            position: relative;
        }
        .panel::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 3px;
            background: linear-gradient(90deg, var(--accent), var(--purple), var(--pink));
        }
        .panel-body { padding: 24px; }
        .panel-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: 20px;
            flex-wrap: wrap;
            gap: 12px;
        }
        .panel-title {
            font-size: 20px;
            font-weight: 700;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        .badge {
            font-size: 11px;
            font-weight: 700;
            padding: 5px 12px;
            border-radius: 20px;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }
        .badge-magic { background: linear-gradient(135deg, var(--accent), var(--purple)); color: #000; }
        
        /* Canvas Area */
        .canvas-container {
            position: relative;
            background: var(--surface);
            border-radius: var(--radius);
            overflow: hidden;
            margin-bottom: 20px;
            border: 2px solid var(--border);
            transition: border-color 0.3s;
        }
        .canvas-container.active { border-color: var(--accent); }
        .canvas-container.transforming {
            animation: magicTransform 1.5s ease;
        }
        
        #sketchCanvas {
            width: 100%;
            aspect-ratio: 4/3;
            display: block;
            cursor: crosshair;
            touch-action: none;
            background: #fafafa;
        }
        
        .canvas-overlay {
            position: absolute;
            inset: 0;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            pointer-events: none;
            text-align: center;
            padding: 24px;
            transition: opacity 0.4s;
            background: rgba(250,250,250,0.9);
        }
        .canvas-overlay.hidden { opacity: 0; }
        .canvas-overlay .icon {
            font-size: 64px;
            margin-bottom: 16px;
            animation: float 3s ease-in-out infinite;
        }
        .canvas-overlay .title {
            font-size: 20px;
            font-weight: 700;
            color: #333;
            margin-bottom: 8px;
        }
        .canvas-overlay .subtitle {
            font-size: 14px;
            color: #666;
            max-width: 280px;
        }
        
        /* Tools */
        .section-label {
            font-size: 12px;
            font-weight: 600;
            color: var(--text-muted);
            text-transform: uppercase;
            letter-spacing: 1px;
            margin-bottom: 12px;
        }
        .tools-row {
            display: flex;
            gap: 8px;
            flex-wrap: wrap;
            margin-bottom: 20px;
        }
        .tool-btn {
            padding: 12px 16px;
            border-radius: 10px;
            border: 1px solid var(--border);
            background: var(--surface);
            color: var(--text);
            font-size: 13px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.2s;
            display: flex;
            align-items: center;
            gap: 6px;
        }
        .tool-btn:hover { background: var(--elevated); border-color: var(--border-hover); transform: translateY(-2px); }
        .tool-btn.active { background: var(--accent); border-color: var(--accent); color: #000; }
        
        /* Colors */
        .colors-row {
            display: flex;
            gap: 8px;
            flex-wrap: wrap;
            align-items: center;
            margin-bottom: 20px;
        }
        .color-swatch {
            width: 36px;
            height: 36px;
            border-radius: 10px;
            cursor: pointer;
            border: 3px solid transparent;
            transition: all 0.2s;
        }
        .color-swatch:hover { transform: scale(1.15); }
        .color-swatch.active { border-color: var(--accent); box-shadow: 0 0 16px var(--accent-glow); }
        
        /* Slider */
        .slider-row {
            display: flex;
            align-items: center;
            gap: 16px;
            margin-bottom: 20px;
        }
        .slider-row label { font-size: 13px; font-weight: 600; color: var(--text-dim); min-width: 60px; }
        .slider-row input[type="range"] {
            flex: 1;
            height: 8px;
            border-radius: 4px;
            appearance: none;
            background: var(--surface);
        }
        .slider-row input[type="range"]::-webkit-slider-thumb {
            appearance: none;
            width: 24px;
            height: 24px;
            border-radius: 50%;
            background: var(--accent);
            cursor: pointer;
            box-shadow: 0 2px 8px var(--accent-glow);
        }
        .slider-row span { font-size: 13px; color: var(--text-muted); min-width: 40px; text-align: right; }
        
        /* Generate Button */
        .generate-btn {
            width: 100%;
            padding: 20px;
            border: none;
            border-radius: 14px;
            font-size: 18px;
            font-weight: 700;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 12px;
            transition: all 0.3s;
            color: #000;
            background: linear-gradient(135deg, var(--accent), #00ffcc);
            position: relative;
            overflow: hidden;
        }
        .generate-btn::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 200%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.3), transparent);
            animation: shimmer 3s infinite;
        }
        .generate-btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 16px 48px var(--accent-glow);
        }
        .generate-btn:disabled { opacity: 0.6; cursor: not-allowed; transform: none; }
        .generate-btn .text { position: relative; z-index: 1; }
        .spinner {
            width: 24px;
            height: 24px;
            border: 3px solid rgba(0,0,0,0.2);
            border-top-color: #000;
            border-radius: 50%;
            animation: spin 0.8s linear infinite;
        }
        
        /* Results Panel */
        .results-intro {
            text-align: center;
            padding: 40px;
            background: var(--surface);
            border-radius: var(--radius);
            margin-bottom: 24px;
        }
        .results-intro .icon { font-size: 48px; margin-bottom: 16px; }
        .results-intro h3 { font-size: 20px; margin-bottom: 8px; }
        .results-intro p { color: var(--text-dim); }
        
        /* Style Cards */
        .styles-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 16px;
            margin-bottom: 24px;
        }
        @media (min-width: 1400px) {
            .styles-grid { grid-template-columns: repeat(3, 1fr); }
        }
        @media (max-width: 700px) {
            .styles-grid { grid-template-columns: 1fr; }
        }
        
        .style-card {
            background: var(--surface);
            border: 2px solid var(--border);
            border-radius: var(--radius);
            overflow: hidden;
            cursor: pointer;
            transition: all 0.3s;
            position: relative;
        }
        .style-card:hover {
            border-color: var(--border-hover);
            transform: translateY(-4px);
            box-shadow: 0 16px 48px rgba(0,0,0,0.3);
        }
        .style-card.selected {
            border-color: var(--accent);
            box-shadow: 0 0 32px var(--accent-glow);
        }
        .style-card.generating::after {
            content: '';
            position: absolute;
            inset: 0;
            background: rgba(0,0,0,0.7);
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        .style-card-image {
            aspect-ratio: 4/3;
            background: #1a1a2e;
            position: relative;
            overflow: hidden;
        }
        .style-card-image canvas {
            width: 100%;
            height: 100%;
            display: block;
        }
        .style-card-placeholder {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            height: 100%;
            padding: 20px;
            text-align: center;
        }
        .style-card-placeholder .icon { font-size: 48px; margin-bottom: 12px; opacity: 0.6; }
        .style-card-placeholder .text { font-size: 13px; color: var(--text-muted); }
        
        .style-card-info {
            padding: 16px;
            background: var(--elevated);
        }
        .style-card-name {
            font-size: 16px;
            font-weight: 700;
            margin-bottom: 4px;
            display: flex;
            align-items: center;
            gap: 8px;
        }
        .style-card-desc {
            font-size: 12px;
            color: var(--text-muted);
        }
        .style-badge {
            font-size: 9px;
            padding: 3px 8px;
            border-radius: 10px;
            font-weight: 700;
            text-transform: uppercase;
        }
        
        .style-card-loading {
            position: absolute;
            inset: 0;
            background: rgba(0,0,0,0.85);
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            gap: 16px;
        }
        .style-card-loading .spinner {
            width: 48px;
            height: 48px;
            border-width: 4px;
            border-color: rgba(255,255,255,0.2);
            border-top-color: var(--accent);
        }
        .style-card-loading .text { font-size: 14px; color: var(--text-dim); }
        
        /* Actions */
        .actions-row {
            display: flex;
            gap: 12px;
            flex-wrap: wrap;
        }
        .action-btn {
            flex: 1;
            min-width: 130px;
            padding: 14px 20px;
            border-radius: 12px;
            border: 1px solid var(--border);
            background: var(--surface);
            color: var(--text);
            font-size: 14px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.2s;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
        }
        .action-btn:hover { background: var(--elevated); transform: translateY(-2px); }
        .action-btn.primary { background: var(--accent); border-color: var(--accent); color: #000; }
        .action-btn:disabled { opacity: 0.5; cursor: not-allowed; }
        
        /* Gallery */
        .gallery-hero {
            text-align: center;
            margin-bottom: 48px;
        }
        .gallery-hero h2 { font-size: 32px; font-weight: 700; margin-bottom: 12px; }
        .gallery-hero p { color: var(--text-dim); }
        
        .gallery-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
            gap: 24px;
        }
        .gallery-item {
            background: var(--card);
            border: 1px solid var(--border);
            border-radius: var(--radius);
            overflow: hidden;
            cursor: pointer;
            transition: all 0.3s;
        }
        .gallery-item:hover {
            transform: translateY(-8px);
            box-shadow: 0 24px 64px rgba(0,0,0,0.4);
            border-color: var(--accent);
        }
        .gallery-item-image {
            aspect-ratio: 4/3;
            background: #1a1a2e;
        }
        .gallery-item-image img, .gallery-item-image canvas {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }
        .gallery-item-info { padding: 16px; }
        .gallery-item-title { font-size: 16px; font-weight: 600; margin-bottom: 4px; }
        .gallery-item-meta { font-size: 12px; color: var(--text-muted); }
        
        /* Toast */
        .toast {
            position: fixed;
            bottom: 24px;
            left: 50%;
            transform: translateX(-50%) translateY(120px);
            padding: 16px 28px;
            background: var(--elevated);
            border: 1px solid var(--border);
            border-radius: 14px;
            font-size: 14px;
            font-weight: 600;
            z-index: 1000;
            opacity: 0;
            transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
            box-shadow: 0 16px 48px rgba(0,0,0,0.4);
            display: flex;
            align-items: center;
            gap: 12px;
        }
        .toast.show { opacity: 1; transform: translateX(-50%) translateY(0); }
        .toast.success { border-color: var(--accent); }
        .toast.error { border-color: #ff4466; }
        
        /* Footer */
        footer {
            text-align: center;
            padding: 32px;
            border-top: 1px solid var(--border);
            color: var(--text-muted);
            font-size: 13px;
        }
        footer strong { color: var(--text); }
        
        /* Mobile */
        @media (max-width: 600px) {
            header { padding: 12px 16px; }
            .logo-icon { width: 44px; height: 44px; font-size: 24px; }
            .logo-text h1 { font-size: 20px; }
            main { padding: 20px 16px 60px; }
            .panel-body { padding: 16px; }
            .generate-btn { padding: 16px; font-size: 16px; }
        }
    </style>
</head>
<body>
    <header>
        <div class="header-inner">
            <div class="logo" onclick="showSection('create')">
                <div class="logo-icon">ü¶é</div>
                <div class="logo-text">
                    <h1>Chameleon Generator</h1>
                    <p>Sketch ‚Üí Art Magic</p>
                </div>
            </div>
            <nav class="nav-pills">
                <button class="nav-pill active" data-section="create" onclick="showSection('create')">‚ú® Create</button>
                <button class="nav-pill" data-section="gallery" onclick="showSection('gallery')">üñºÔ∏è Gallery</button>
                <button class="nav-pill" data-section="saved" onclick="showSection('saved')">üíæ Saved</button>
            </nav>
        </div>
    </header>
    
    <main>
        <!-- CREATE -->
        <section id="section-create" class="section active">
            <div class="hero">
                <div class="hero-badge">
                    <span class="dot"></span>
                    <span>6 Art Styles ‚Ä¢ Real Transformation ‚Ä¢ Offline Ready</span>
                </div>
                <h2>Sketch Anything. <span>Watch It Transform.</span></h2>
                <p>Draw a simple house, flower, or face ‚Äî our AI engine transforms it into 6 completely different artistic interpretations.</p>
            </div>
            
            <div class="app-grid">
                <!-- Drawing Panel -->
                <div class="panel">
                    <div class="panel-body">
                        <div class="panel-header">
                            <div class="panel-title">üé® Your Sketch</div>
                            <span class="badge badge-magic">Draw Here</span>
                        </div>
                        
                        <div class="canvas-container" id="canvasContainer">
                            <canvas id="sketchCanvas"></canvas>
                            <div class="canvas-overlay" id="canvasOverlay">
                                <div class="icon">‚úèÔ∏è</div>
                                <div class="title">Start Sketching!</div>
                                <div class="subtitle">Draw a house, flower, tree, face ‚Äî anything! We'll transform it into art.</div>
                            </div>
                        </div>
                        
                        <div class="section-label">Drawing Tools</div>
                        <div class="tools-row">
                            <button class="tool-btn active" data-tool="pen" onclick="setTool('pen')">‚úèÔ∏è Pen</button>
                            <button class="tool-btn" data-tool="brush" onclick="setTool('brush')">üñåÔ∏è Brush</button>
                            <button class="tool-btn" data-tool="marker" onclick="setTool('marker')">üñçÔ∏è Marker</button>
                            <button class="tool-btn" data-tool="eraser" onclick="setTool('eraser')">üßΩ Eraser</button>
                            <button class="tool-btn" onclick="clearCanvas()">üóëÔ∏è Clear</button>
                            <button class="tool-btn" onclick="undoStroke()">‚Ü©Ô∏è Undo</button>
                        </div>
                        
                        <div class="section-label">Colors</div>
                        <div class="colors-row">
                            <div class="color-swatch active" style="background:#000" data-color="#000000" onclick="setColor('#000000')"></div>
                            <div class="color-swatch" style="background:#444" data-color="#444444" onclick="setColor('#444444')"></div>
                            <div class="color-swatch" style="background:#888" data-color="#888888" onclick="setColor('#888888')"></div>
                            <div class="color-swatch" style="background:#e74c3c" data-color="#e74c3c" onclick="setColor('#e74c3c')"></div>
                            <div class="color-swatch" style="background:#e67e22" data-color="#e67e22" onclick="setColor('#e67e22')"></div>
                            <div class="color-swatch" style="background:#f1c40f" data-color="#f1c40f" onclick="setColor('#f1c40f')"></div>
                            <div class="color-swatch" style="background:#2ecc71" data-color="#2ecc71" onclick="setColor('#2ecc71')"></div>
                            <div class="color-swatch" style="background:#3498db" data-color="#3498db" onclick="setColor('#3498db')"></div>
                            <div class="color-swatch" style="background:#9b59b6" data-color="#9b59b6" onclick="setColor('#9b59b6')"></div>
                            <div class="color-swatch" style="background:#e91e63" data-color="#e91e63" onclick="setColor('#e91e63')"></div>
                            <input type="color" id="customColor" value="#00d4aa" style="width:36px;height:36px;border:none;border-radius:10px;cursor:pointer" onchange="setColor(this.value)">
                        </div>
                        
                        <div class="slider-row">
                            <label>Stroke</label>
                            <input type="range" id="strokeSize" min="1" max="30" value="4" oninput="setStrokeSize(this.value)">
                            <span id="strokeDisplay">4px</span>
                        </div>
                        
                        <button class="generate-btn" id="generateBtn" onclick="transformSketch()">
                            <span class="text">ü¶é Transform Into 6 Art Styles</span>
                        </button>
                    </div>
                </div>
                
                <!-- Results Panel -->
                <div class="panel">
                    <div class="panel-body">
                        <div class="panel-header">
                            <div class="panel-title">‚ú® Art Transformations</div>
                            <span class="badge badge-magic">6 Styles</span>
                        </div>
                        
                        <div id="resultsArea">
                            <div class="results-intro">
                                <div class="icon">üé®</div>
                                <h3>Your Art Awaits</h3>
                                <p>Draw something on the left, then click "Transform" to see it recreated in 6 stunning styles!</p>
                            </div>
                        </div>
                        
                        <div class="styles-grid" id="stylesGrid" style="display:none;">
                            <!-- Comic -->
                            <div class="style-card" id="card-comic" onclick="selectStyle('comic')">
                                <div class="style-card-image" id="img-comic">
                                    <div class="style-card-placeholder">
                                        <span class="icon">üí•</span>
                                        <span class="text">Comic Style</span>
                                    </div>
                                </div>
                                <div class="style-card-info">
                                    <div class="style-card-name">üí• Comic Book <span class="style-badge" style="background:var(--comic);color:#fff">Bold</span></div>
                                    <div class="style-card-desc">Bold outlines, halftone dots, vibrant pop art</div>
                                </div>
                            </div>
                            
                            <!-- Realistic -->
                            <div class="style-card" id="card-realistic" onclick="selectStyle('realistic')">
                                <div class="style-card-image" id="img-realistic">
                                    <div class="style-card-placeholder">
                                        <span class="icon">üì∑</span>
                                        <span class="text">Realistic Style</span>
                                    </div>
                                </div>
                                <div class="style-card-info">
                                    <div class="style-card-name">üì∑ Realistic <span class="style-badge" style="background:var(--realistic);color:#fff">Photo</span></div>
                                    <div class="style-card-desc">Depth, shadows, natural lighting, 3D form</div>
                                </div>
                            </div>
                            
                            <!-- Postcard -->
                            <div class="style-card" id="card-postcard" onclick="selectStyle('postcard')">
                                <div class="style-card-image" id="img-postcard">
                                    <div class="style-card-placeholder">
                                        <span class="icon">üèñÔ∏è</span>
                                        <span class="text">Postcard Style</span>
                                    </div>
                                </div>
                                <div class="style-card-info">
                                    <div class="style-card-name">üèñÔ∏è Postcard <span class="style-badge" style="background:var(--postcard);color:#fff">Vintage</span></div>
                                    <div class="style-card-desc">Warm tones, nostalgic filter, travel vibe</div>
                                </div>
                            </div>
                            
                            <!-- Stencil -->
                            <div class="style-card" id="card-stencil" onclick="selectStyle('stencil')">
                                <div class="style-card-image" id="img-stencil">
                                    <div class="style-card-placeholder">
                                        <span class="icon">üé≠</span>
                                        <span class="text">Stencil Style</span>
                                    </div>
                                </div>
                                <div class="style-card-info">
                                    <div class="style-card-name">üé≠ Stencil <span class="style-badge" style="background:var(--stencil);color:#fff">Street</span></div>
                                    <div class="style-card-desc">High contrast, spray paint, graffiti art</div>
                                </div>
                            </div>
                            
                            <!-- Watercolor -->
                            <div class="style-card" id="card-watercolor" onclick="selectStyle('watercolor')">
                                <div class="style-card-image" id="img-watercolor">
                                    <div class="style-card-placeholder">
                                        <span class="icon">üé®</span>
                                        <span class="text">Watercolor Style</span>
                                    </div>
                                </div>
                                <div class="style-card-info">
                                    <div class="style-card-name">üé® Watercolor <span class="style-badge" style="background:var(--watercolor);color:#fff">Soft</span></div>
                                    <div class="style-card-desc">Soft edges, paint bleeding, artistic flow</div>
                                </div>
                            </div>
                            
                            <!-- Funky -->
                            <div class="style-card" id="card-funky" onclick="selectStyle('funky')">
                                <div class="style-card-image" id="img-funky">
                                    <div class="style-card-placeholder">
                                        <span class="icon">üåà</span>
                                        <span class="text">Funky Style</span>
                                    </div>
                                </div>
                                <div class="style-card-info">
                                    <div class="style-card-name">üåà Funky <span class="style-badge" style="background:var(--funky);color:#fff">Wild</span></div>
                                    <div class="style-card-desc">Crazy colors, distortion, psychedelic vibes</div>
                                </div>
                            </div>
                        </div>
                        
                        <div class="actions-row" id="actionsRow" style="display:none;">
                            <button class="action-btn" onclick="regenerate()">üîÑ Regenerate</button>
                            <button class="action-btn" onclick="downloadSelected()" id="downloadBtn" disabled>‚¨áÔ∏è Download</button>
                            <button class="action-btn" onclick="downloadAll()">üì¶ All 6</button>
                            <button class="action-btn primary" onclick="saveToGallery()">üíæ Save</button>
                        </div>
                    </div>
                </div>
            </div>
        </section>
        
        <!-- GALLERY -->
        <section id="section-gallery" class="section">
            <div class="gallery-hero">
                <h2>üñºÔ∏è Inspiration Gallery</h2>
                <p>See what's possible. Click any piece to use as inspiration.</p>
            </div>
            <div class="gallery-grid" id="galleryGrid"></div>
        </section>
        
        <!-- SAVED -->
        <section id="section-saved" class="section">
            <div class="gallery-hero">
                <h2>üíæ Your Saved Creations</h2>
                <p>All your masterpieces, stored locally.</p>
            </div>
            <div class="gallery-grid" id="savedGrid"></div>
        </section>
    </main>
    
    <footer>
        <p><strong>Chameleon Generator‚Ñ¢</strong> ‚Ä¢ Sketch ‚Üí Art Magic ‚Ä¢ 100% Offline ‚Ä¢ by Stellar Studios</p>
    </footer>
    
    <div class="toast" id="toast"></div>
    
    <script>
    (function() {
        'use strict';
        
        // ============ STATE ============
        let canvas, ctx;
        let isDrawing = false;
        let hasDrawn = false;
        let currentTool = 'pen';
        let currentColor = '#000000';
        let strokeSize = 4;
        let strokeHistory = [];
        let currentStroke = [];
        let selectedStyle = null;
        let generatedCanvases = {};
        let savedItems = [];
        
        // ============ STYLE DEFINITIONS ============
        const STYLES = {
            comic: {
                name: 'Comic Book',
                icon: 'üí•',
                color: '#ff3366',
                transform: transformComic
            },
            realistic: {
                name: 'Realistic',
                icon: 'üì∑',
                color: '#00cc88',
                transform: transformRealistic
            },
            postcard: {
                name: 'Postcard',
                icon: 'üèñÔ∏è',
                color: '#ffaa33',
                transform: transformPostcard
            },
            stencil: {
                name: 'Stencil',
                icon: 'üé≠',
                color: '#6644ff',
                transform: transformStencil
            },
            watercolor: {
                name: 'Watercolor',
                icon: 'üé®',
                color: '#44aaff',
                transform: transformWatercolor
            },
            funky: {
                name: 'Funky',
                icon: 'üåà',
                color: '#ff44aa',
                transform: transformFunky
            }
        };
        
        // ============ INIT ============
        document.addEventListener('DOMContentLoaded', () => {
            initCanvas();
            loadSaved();
            initGallery();
        });
        
        function initCanvas() {
            canvas = document.getElementById('sketchCanvas');
            ctx = canvas.getContext('2d', { willReadFrequently: true });
            
            const container = canvas.parentElement;
            const rect = container.getBoundingClientRect();
            
            canvas.width = rect.width * 2;
            canvas.height = (rect.width * 0.75) * 2;
            canvas.style.width = rect.width + 'px';
            canvas.style.height = (rect.width * 0.75) + 'px';
            
            ctx.fillStyle = '#fafafa';
            ctx.fillRect(0, 0, canvas.width, canvas.height);
            ctx.lineCap = 'round';
            ctx.lineJoin = 'round';
            
            // Mouse events
            canvas.addEventListener('mousedown', startStroke);
            canvas.addEventListener('mousemove', continueStroke);
            canvas.addEventListener('mouseup', endStroke);
            canvas.addEventListener('mouseleave', endStroke);
            
            // Touch events
            canvas.addEventListener('touchstart', e => { e.preventDefault(); startStroke(e.touches[0]); });
            canvas.addEventListener('touchmove', e => { e.preventDefault(); continueStroke(e.touches[0]); });
            canvas.addEventListener('touchend', endStroke);
        }
        
        function getCanvasPos(e) {
            const rect = canvas.getBoundingClientRect();
            const scaleX = canvas.width / rect.width;
            const scaleY = canvas.height / rect.height;
            return {
                x: (e.clientX - rect.left) * scaleX,
                y: (e.clientY - rect.top) * scaleY
            };
        }
        
        function startStroke(e) {
            isDrawing = true;
            const pos = getCanvasPos(e);
            currentStroke = [{ x: pos.x, y: pos.y, color: currentColor, size: strokeSize, tool: currentTool }];
            
            ctx.beginPath();
            ctx.moveTo(pos.x, pos.y);
            
            if (!hasDrawn) {
                hasDrawn = true;
                document.getElementById('canvasOverlay').classList.add('hidden');
                document.getElementById('canvasContainer').classList.add('active');
            }
        }
        
        function continueStroke(e) {
            if (!isDrawing) return;
            const pos = getCanvasPos(e);
            currentStroke.push({ x: pos.x, y: pos.y });
            
            const scale = canvas.width / canvas.offsetWidth;
            let size = strokeSize * scale;
            
            // Tool variations
            if (currentTool === 'eraser') {
                ctx.globalCompositeOperation = 'destination-out';
                ctx.strokeStyle = 'rgba(0,0,0,1)';
                size *= 3;
            } else {
                ctx.globalCompositeOperation = 'source-over';
                ctx.strokeStyle = currentColor;
                
                if (currentTool === 'brush') {
                    size *= 2;
                    ctx.globalAlpha = 0.7;
                } else if (currentTool === 'marker') {
                    size *= 3;
                    ctx.globalAlpha = 0.4;
                } else {
                    ctx.globalAlpha = 1;
                }
            }
            
            ctx.lineWidth = size;
            ctx.lineTo(pos.x, pos.y);
            ctx.stroke();
            ctx.beginPath();
            ctx.moveTo(pos.x, pos.y);
        }
        
        function endStroke() {
            if (isDrawing && currentStroke.length > 0) {
                strokeHistory.push([...currentStroke]);
            }
            isDrawing = false;
            ctx.globalAlpha = 1;
            ctx.globalCompositeOperation = 'source-over';
            currentStroke = [];
        }
        
        // ============ TOOLS ============
        window.setTool = function(tool) {
            currentTool = tool;
            document.querySelectorAll('.tool-btn[data-tool]').forEach(btn => {
                btn.classList.toggle('active', btn.dataset.tool === tool);
            });
        };
        
        window.setColor = function(color) {
            currentColor = color;
            document.querySelectorAll('.color-swatch').forEach(s => {
                s.classList.toggle('active', s.dataset.color === color);
            });
        };
        
        window.setStrokeSize = function(size) {
            strokeSize = parseInt(size);
            document.getElementById('strokeDisplay').textContent = size + 'px';
        };
        
        window.clearCanvas = function() {
            ctx.fillStyle = '#fafafa';
            ctx.fillRect(0, 0, canvas.width, canvas.height);
            strokeHistory = [];
            hasDrawn = false;
            document.getElementById('canvasOverlay').classList.remove('hidden');
            document.getElementById('canvasContainer').classList.remove('active');
            toast('Canvas cleared');
        };
        
        window.undoStroke = function() {
            if (strokeHistory.length === 0) return;
            strokeHistory.pop();
            redrawCanvas();
            toast('Undone');
        };
        
        function redrawCanvas() {
            ctx.fillStyle = '#fafafa';
            ctx.fillRect(0, 0, canvas.width, canvas.height);
            
            strokeHistory.forEach(stroke => {
                if (stroke.length === 0) return;
                ctx.beginPath();
                ctx.strokeStyle = stroke[0].color;
                ctx.lineWidth = stroke[0].size * (canvas.width / canvas.offsetWidth);
                ctx.moveTo(stroke[0].x, stroke[0].y);
                
                for (let i = 1; i < stroke.length; i++) {
                    ctx.lineTo(stroke[i].x, stroke[i].y);
                }
                ctx.stroke();
            });
        }
        
        // ============ TRANSFORMATION ENGINE ============
        window.transformSketch = function() {
            if (!hasDrawn) {
                toast('Draw something first!', 'error');
                return;
            }
            
            const btn = document.getElementById('generateBtn');
            btn.disabled = true;
            btn.innerHTML = '<div class="spinner"></div><span class="text">Transforming...</span>';
            
            document.getElementById('canvasContainer').classList.add('transforming');
            document.getElementById('resultsArea').style.display = 'none';
            document.getElementById('stylesGrid').style.display = 'grid';
            document.getElementById('actionsRow').style.display = 'flex';
            
            // Generate all 6 styles
            const styleKeys = Object.keys(STYLES);
            let completed = 0;
            
            styleKeys.forEach((key, idx) => {
                const card = document.getElementById('card-' + key);
                const imgContainer = document.getElementById('img-' + key);
                
                // Show loading
                imgContainer.innerHTML = `<div class="style-card-loading"><div class="spinner"></div><div class="text">Creating ${STYLES[key].name}...</div></div>`;
                
                setTimeout(() => {
                    // Create transformed canvas
                    const resultCanvas = document.createElement('canvas');
                    resultCanvas.width = canvas.width;
                    resultCanvas.height = canvas.height;
                    const rctx = resultCanvas.getContext('2d');
                    
                    // Copy original
                    rctx.drawImage(canvas, 0, 0);
                    
                    // Apply transformation
                    STYLES[key].transform(rctx, resultCanvas);
                    
                    // Store result
                    generatedCanvases[key] = resultCanvas;
                    
                    // Display
                    imgContainer.innerHTML = '';
                    const displayCanvas = document.createElement('canvas');
                    displayCanvas.width = resultCanvas.width;
                    displayCanvas.height = resultCanvas.height;
                    displayCanvas.getContext('2d').drawImage(resultCanvas, 0, 0);
                    displayCanvas.style.width = '100%';
                    displayCanvas.style.height = '100%';
                    imgContainer.appendChild(displayCanvas);
                    
                    completed++;
                    if (completed === 6) {
                        btn.disabled = false;
                        btn.innerHTML = '<span class="text">ü¶é Transform Into 6 Art Styles</span>';
                        document.getElementById('canvasContainer').classList.remove('transforming');
                        toast('‚ú® 6 styles created!', 'success');
                    }
                }, 300 + (idx * 400));
            });
        };
        
        // ============ TRANSFORMATION FUNCTIONS ============
        
        // COMIC: Bold outlines, posterize, halftone
        function transformComic(ctx, canvas) {
            const imgData = ctx.getImageData(0, 0, canvas.width, canvas.height);
            const data = imgData.data;
            const width = canvas.width;
            const height = canvas.height;
            
            // Edge detection for bold outlines
            const edges = detectEdges(data, width, height);
            
            // Posterize to 4 levels + boost saturation
            for (let i = 0; i < data.length; i += 4) {
                // Posterize
                data[i] = Math.floor(data[i] / 64) * 85;
                data[i+1] = Math.floor(data[i+1] / 64) * 85;
                data[i+2] = Math.floor(data[i+2] / 64) * 85;
                
                // Boost saturation
                const avg = (data[i] + data[i+1] + data[i+2]) / 3;
                data[i] = clamp(data[i] + (data[i] - avg) * 0.8);
                data[i+1] = clamp(data[i+1] + (data[i+1] - avg) * 0.8);
                data[i+2] = clamp(data[i+2] + (data[i+2] - avg) * 0.8);
            }
            
            // Apply edges as black outlines
            for (let i = 0; i < edges.length; i++) {
                if (edges[i] > 100) {
                    const idx = i * 4;
                    data[idx] = 0;
                    data[idx+1] = 0;
                    data[idx+2] = 0;
                }
            }
            
            ctx.putImageData(imgData, 0, 0);
            
            // Add halftone dots
            ctx.globalAlpha = 0.15;
            ctx.fillStyle = '#000';
            for (let y = 0; y < height; y += 10) {
                for (let x = 0; x < width; x += 10) {
                    if ((x + y) % 20 === 0) {
                        ctx.beginPath();
                        ctx.arc(x, y, 2.5, 0, Math.PI * 2);
                        ctx.fill();
                    }
                }
            }
            ctx.globalAlpha = 1;
            
            // Bold border
            ctx.strokeStyle = '#000';
            ctx.lineWidth = 8;
            ctx.strokeRect(8, 8, width - 16, height - 16);
        }
        
        // REALISTIC: Shading, depth, soft lighting
        function transformRealistic(ctx, canvas) {
            const imgData = ctx.getImageData(0, 0, canvas.width, canvas.height);
            const data = imgData.data;
            const width = canvas.width;
            const height = canvas.height;
            
            // Apply gaussian blur for smoothing
            applyBlur(data, width, height, 2);
            
            // Add depth through shadows
            for (let y = 0; y < height; y++) {
                for (let x = 0; x < width; x++) {
                    const idx = (y * width + x) * 4;
                    
                    // Skip background
                    if (data[idx] > 240 && data[idx+1] > 240 && data[idx+2] > 240) continue;
                    
                    // Calculate fake 3D shading based on position
                    const lightX = width * 0.3;
                    const lightY = height * 0.2;
                    const dist = Math.sqrt(Math.pow(x - lightX, 2) + Math.pow(y - lightY, 2));
                    const maxDist = Math.sqrt(width * width + height * height);
                    const shadow = 1 - (dist / maxDist) * 0.4;
                    
                    // Apply lighting
                    data[idx] = clamp(data[idx] * shadow + 20);
                    data[idx+1] = clamp(data[idx+1] * shadow + 15);
                    data[idx+2] = clamp(data[idx+2] * shadow + 10);
                }
            }
            
            // Add subtle noise for texture
            for (let i = 0; i < data.length; i += 4) {
                const noise = (Math.random() - 0.5) * 15;
                data[i] = clamp(data[i] + noise);
                data[i+1] = clamp(data[i+1] + noise);
                data[i+2] = clamp(data[i+2] + noise);
            }
            
            ctx.putImageData(imgData, 0, 0);
            
            // Add ambient occlusion at edges
            const edges = detectEdges(data, width, height);
            ctx.globalAlpha = 0.2;
            ctx.fillStyle = '#000';
            for (let y = 0; y < height; y++) {
                for (let x = 0; x < width; x++) {
                    if (edges[y * width + x] > 50) {
                        ctx.fillRect(x + 2, y + 2, 3, 3);
                    }
                }
            }
            ctx.globalAlpha = 1;
        }
        
        // POSTCARD: Warm vintage tones, vignette, grain
        function transformPostcard(ctx, canvas) {
            const imgData = ctx.getImageData(0, 0, canvas.width, canvas.height);
            const data = imgData.data;
            const width = canvas.width;
            const height = canvas.height;
            const cx = width / 2;
            const cy = height / 2;
            
            for (let y = 0; y < height; y++) {
                for (let x = 0; x < width; x++) {
                    const idx = (y * width + x) * 4;
                    
                    // Warm sepia-ish tint
                    const r = data[idx];
                    const g = data[idx+1];
                    const b = data[idx+2];
                    
                    data[idx] = clamp(r * 1.1 + 30);     // More red
                    data[idx+1] = clamp(g * 1.0 + 15);   // Slight yellow
                    data[idx+2] = clamp(b * 0.8 - 10);   // Less blue
                    
                    // Vignette
                    const dist = Math.sqrt(Math.pow(x - cx, 2) + Math.pow(y - cy, 2));
                    const maxDist = Math.sqrt(cx * cx + cy * cy);
                    const vignette = 1 - Math.pow(dist / maxDist, 2) * 0.5;
                    
                    data[idx] = clamp(data[idx] * vignette);
                    data[idx+1] = clamp(data[idx+1] * vignette);
                    data[idx+2] = clamp(data[idx+2] * vignette);
                    
                    // Film grain
                    const grain = (Math.random() - 0.5) * 20;
                    data[idx] = clamp(data[idx] + grain);
                    data[idx+1] = clamp(data[idx+1] + grain);
                    data[idx+2] = clamp(data[idx+2] + grain);
                }
            }
            
            ctx.putImageData(imgData, 0, 0);
            
            // Add vintage border
            ctx.strokeStyle = '#8b7355';
            ctx.lineWidth = 20;
            ctx.strokeRect(15, 15, width - 30, height - 30);
            
            // Inner white border
            ctx.strokeStyle = '#f5f0e8';
            ctx.lineWidth = 6;
            ctx.strokeRect(30, 30, width - 60, height - 60);
        }
        
        // STENCIL: High contrast, spray paint effect
        function transformStencil(ctx, canvas) {
            const imgData = ctx.getImageData(0, 0, canvas.width, canvas.height);
            const data = imgData.data;
            const width = canvas.width;
            const height = canvas.height;
            
            // Convert to high contrast B&W
            for (let i = 0; i < data.length; i += 4) {
                const gray = data[i] * 0.299 + data[i+1] * 0.587 + data[i+2] * 0.114;
                const val = gray > 140 ? 255 : 0;  // Hard threshold
                data[i] = val;
                data[i+1] = val;
                data[i+2] = val;
            }
            
            ctx.putImageData(imgData, 0, 0);
            
            // Add spray paint texture
            ctx.globalAlpha = 0.08;
            for (let i = 0; i < 3000; i++) {
                const x = Math.random() * width;
                const y = Math.random() * height;
                const size = Math.random() * 4 + 1;
                ctx.fillStyle = Math.random() > 0.5 ? '#000' : '#fff';
                ctx.beginPath();
                ctx.arc(x, y, size, 0, Math.PI * 2);
                ctx.fill();
            }
            ctx.globalAlpha = 1;
            
            // Add color overlay option
            ctx.globalCompositeOperation = 'multiply';
            ctx.fillStyle = '#6644ff';
            ctx.globalAlpha = 0.15;
            ctx.fillRect(0, 0, width, height);
            ctx.globalCompositeOperation = 'source-over';
            ctx.globalAlpha = 1;
        }
        
        // WATERCOLOR: Soft edges, paint bleeding, washes
        function transformWatercolor(ctx, canvas) {
            const imgData = ctx.getImageData(0, 0, canvas.width, canvas.height);
            const data = imgData.data;
            const width = canvas.width;
            const height = canvas.height;
            
            // Heavy blur for soft edges
            applyBlur(data, width, height, 4);
            
            // Lighten and add transparency feel
            for (let i = 0; i < data.length; i += 4) {
                // Skip near-white (paper)
                if (data[i] > 230 && data[i+1] > 230 && data[i+2] > 230) continue;
                
                // Boost colors slightly
                data[i] = clamp(data[i] * 1.1 + 30);
                data[i+1] = clamp(data[i+1] * 1.1 + 30);
                data[i+2] = clamp(data[i+2] * 1.1 + 30);
                
                // Add slight color variation
                const shift = (Math.random() - 0.5) * 25;
                data[i] = clamp(data[i] + shift);
                data[i+1] = clamp(data[i+1] + shift * 0.8);
                data[i+2] = clamp(data[i+2] + shift * 0.6);
            }
            
            ctx.putImageData(imgData, 0, 0);
            
            // Add paint bleed effect
            ctx.globalAlpha = 0.03;
            for (let i = 0; i < 500; i++) {
                const x = Math.random() * width;
                const y = Math.random() * height;
                const radius = Math.random() * 50 + 20;
                
                const gradient = ctx.createRadialGradient(x, y, 0, x, y, radius);
                const hue = Math.random() * 360;
                gradient.addColorStop(0, `hsla(${hue}, 70%, 60%, 0.3)`);
                gradient.addColorStop(1, 'transparent');
                
                ctx.fillStyle = gradient;
                ctx.beginPath();
                ctx.arc(x, y, radius, 0, Math.PI * 2);
                ctx.fill();
            }
            ctx.globalAlpha = 1;
            
            // Paper texture
            ctx.fillStyle = 'rgba(245, 242, 235, 0.3)';
            ctx.fillRect(0, 0, width, height);
        }
        
        // FUNKY: Wild colors, distortion, psychedelic
        function transformFunky(ctx, canvas) {
            const imgData = ctx.getImageData(0, 0, canvas.width, canvas.height);
            const data = imgData.data;
            const width = canvas.width;
            const height = canvas.height;
            
            // Color channel shifting and inversion
            for (let y = 0; y < height; y++) {
                for (let x = 0; x < width; x++) {
                    const idx = (y * width + x) * 4;
                    
                    // Skip background
                    if (data[idx] > 240 && data[idx+1] > 240 && data[idx+2] > 240) continue;
                    
                    // Rotate color channels based on position
                    const angle = (x + y) * 0.02;
                    const r = data[idx];
                    const g = data[idx+1];
                    const b = data[idx+2];
                    
                    // Wild color transformation
                    data[idx] = clamp((Math.sin(angle) + 1) * 127 + r * 0.3);
                    data[idx+1] = clamp((Math.cos(angle * 1.5) + 1) * 127 + g * 0.3);
                    data[idx+2] = clamp((Math.sin(angle * 2) + 1) * 127 + b * 0.3);
                    
                    // Boost saturation heavily
                    const avg = (data[idx] + data[idx+1] + data[idx+2]) / 3;
                    data[idx] = clamp(data[idx] + (data[idx] - avg) * 1.5);
                    data[idx+1] = clamp(data[idx+1] + (data[idx+1] - avg) * 1.5);
                    data[idx+2] = clamp(data[idx+2] + (data[idx+2] - avg) * 1.5);
                }
            }
            
            ctx.putImageData(imgData, 0, 0);
            
            // Add rainbow gradient overlay
            const gradient = ctx.createLinearGradient(0, 0, width, height);
            gradient.addColorStop(0, 'rgba(255,0,0,0.1)');
            gradient.addColorStop(0.2, 'rgba(255,165,0,0.1)');
            gradient.addColorStop(0.4, 'rgba(255,255,0,0.1)');
            gradient.addColorStop(0.6, 'rgba(0,255,0,0.1)');
            gradient.addColorStop(0.8, 'rgba(0,0,255,0.1)');
            gradient.addColorStop(1, 'rgba(238,130,238,0.1)');
            ctx.fillStyle = gradient;
            ctx.fillRect(0, 0, width, height);
            
            // Add some random shapes
            ctx.globalAlpha = 0.1;
            for (let i = 0; i < 20; i++) {
                ctx.fillStyle = `hsl(${Math.random() * 360}, 100%, 50%)`;
                ctx.beginPath();
                ctx.arc(
                    Math.random() * width,
                    Math.random() * height,
                    Math.random() * 80 + 20,
                    0, Math.PI * 2
                );
                ctx.fill();
            }
            ctx.globalAlpha = 1;
        }
        
        // ============ HELPER FUNCTIONS ============
        
        function detectEdges(data, width, height) {
            const edges = new Float32Array(width * height);
            const sobelX = [-1, 0, 1, -2, 0, 2, -1, 0, 1];
            const sobelY = [-1, -2, -1, 0, 0, 0, 1, 2, 1];
            
            for (let y = 1; y < height - 1; y++) {
                for (let x = 1; x < width - 1; x++) {
                    let gx = 0, gy = 0;
                    
                    for (let ky = -1; ky <= 1; ky++) {
                        for (let kx = -1; kx <= 1; kx++) {
                            const idx = ((y + ky) * width + (x + kx)) * 4;
                            const gray = (data[idx] + data[idx+1] + data[idx+2]) / 3;
                            const ki = (ky + 1) * 3 + (kx + 1);
                            gx += gray * sobelX[ki];
                            gy += gray * sobelY[ki];
                        }
                    }
                    
                    edges[y * width + x] = Math.sqrt(gx * gx + gy * gy);
                }
            }
            
            return edges;
        }
        
        function applyBlur(data, width, height, radius) {
            const temp = new Uint8ClampedArray(data.length);
            
            // Horizontal pass
            for (let y = 0; y < height; y++) {
                for (let x = 0; x < width; x++) {
                    let r = 0, g = 0, b = 0, count = 0;
                    
                    for (let dx = -radius; dx <= radius; dx++) {
                        const nx = x + dx;
                        if (nx >= 0 && nx < width) {
                            const idx = (y * width + nx) * 4;
                            r += data[idx];
                            g += data[idx+1];
                            b += data[idx+2];
                            count++;
                        }
                    }
                    
                    const idx = (y * width + x) * 4;
                    temp[idx] = r / count;
                    temp[idx+1] = g / count;
                    temp[idx+2] = b / count;
                    temp[idx+3] = data[idx+3];
                }
            }
            
            // Vertical pass
            for (let y = 0; y < height; y++) {
                for (let x = 0; x < width; x++) {
                    let r = 0, g = 0, b = 0, count = 0;
                    
                    for (let dy = -radius; dy <= radius; dy++) {
                        const ny = y + dy;
                        if (ny >= 0 && ny < height) {
                            const idx = (ny * width + x) * 4;
                            r += temp[idx];
                            g += temp[idx+1];
                            b += temp[idx+2];
                            count++;
                        }
                    }
                    
                    const idx = (y * width + x) * 4;
                    data[idx] = r / count;
                    data[idx+1] = g / count;
                    data[idx+2] = b / count;
                }
            }
        }
        
        function clamp(val, min = 0, max = 255) {
            return Math.max(min, Math.min(max, Math.round(val)));
        }
        
        // ============ UI FUNCTIONS ============
        
        window.selectStyle = function(style) {
            selectedStyle = style;
            document.querySelectorAll('.style-card').forEach(card => {
                card.classList.toggle('selected', card.id === 'card-' + style);
            });
            document.getElementById('downloadBtn').disabled = false;
            toast(`Selected: ${STYLES[style].name}`);
        };
        
        window.regenerate = function() {
            if (hasDrawn) transformSketch();
        };
        
        window.downloadSelected = function() {
            if (!selectedStyle || !generatedCanvases[selectedStyle]) {
                toast('Select a style first', 'error');
                return;
            }
            
            const link = document.createElement('a');
            link.download = `chameleon-${selectedStyle}-${Date.now()}.png`;
            link.href = generatedCanvases[selectedStyle].toDataURL('image/png');
            link.click();
            toast('Downloaded!');
        };
        
        window.downloadAll = function() {
            Object.keys(generatedCanvases).forEach((style, i) => {
                setTimeout(() => {
                    const link = document.createElement('a');
                    link.download = `chameleon-${style}-${Date.now()}.png`;
                    link.href = generatedCanvases[style].toDataURL('image/png');
                    link.click();
                }, i * 400);
            });
            toast('Downloading all 6...');
        };
        
        window.saveToGallery = function() {
            if (Object.keys(generatedCanvases).length === 0) {
                toast('Generate art first', 'error');
                return;
            }
            
            const item = {
                id: Date.now(),
                date: new Date().toLocaleDateString(),
                original: canvas.toDataURL('image/png'),
                styles: {}
            };
            
            Object.keys(generatedCanvases).forEach(style => {
                item.styles[style] = generatedCanvases[style].toDataURL('image/png');
            });
            
            savedItems.push(item);
            saveToDisk();
            renderSaved();
            toast('üíæ Saved!');
        };
        
        function saveToDisk() {
            try {
                localStorage.setItem('chameleon_gen_v2', JSON.stringify(savedItems));
            } catch (e) {
                console.warn('Storage failed');
            }
        }
        
        function loadSaved() {
            try {
                const data = localStorage.getItem('chameleon_gen_v2');
                if (data) {
                    savedItems = JSON.parse(data);
                    renderSaved();
                }
            } catch (e) {
                savedItems = [];
            }
        }
        
        function renderSaved() {
            const grid = document.getElementById('savedGrid');
            
            if (savedItems.length === 0) {
                grid.innerHTML = `
                    <div style="grid-column:1/-1;text-align:center;padding:60px;background:var(--card);border-radius:var(--radius-lg);border:1px dashed var(--border);">
                        <div style="font-size:64px;margin-bottom:16px;opacity:0.4">ü¶é</div>
                        <h3 style="margin-bottom:8px">No Saved Art</h3>
                        <p style="color:var(--text-muted)">Create and save your first transformation!</p>
                    </div>
                `;
                return;
            }
            
            let html = '';
            savedItems.forEach(item => {
                const firstStyle = Object.keys(item.styles)[0];
                html += `
                    <div class="gallery-item" onclick="loadSaved(${item.id})">
                        <div class="gallery-item-image">
                            <img src="${item.styles[firstStyle]}" alt="Saved art">
                        </div>
                        <div class="gallery-item-info">
                            <div class="gallery-item-title">Creation</div>
                            <div class="gallery-item-meta">${item.date} ‚Ä¢ 6 styles</div>
                        </div>
                    </div>
                `;
            });
            grid.innerHTML = html;
        }
        
        window.loadSaved = function(id) {
            const item = savedItems.find(i => i.id === id);
            if (!item) return;
            
            // Load styles into view
            Object.keys(item.styles).forEach(style => {
                const img = new Image();
                img.onload = function() {
                    const cvs = document.createElement('canvas');
                    cvs.width = img.width;
                    cvs.height = img.height;
                    cvs.getContext('2d').drawImage(img, 0, 0);
                    generatedCanvases[style] = cvs;
                    
                    const container = document.getElementById('img-' + style);
                    container.innerHTML = '';
                    const display = cvs.cloneNode();
                    display.getContext('2d').drawImage(cvs, 0, 0);
                    display.style.width = '100%';
                    display.style.height = '100%';
                    container.appendChild(display);
                };
                img.src = item.styles[style];
            });
            
            document.getElementById('resultsArea').style.display = 'none';
            document.getElementById('stylesGrid').style.display = 'grid';
            document.getElementById('actionsRow').style.display = 'flex';
            
            showSection('create');
            toast('Loaded!');
        };
        
        function initGallery() {
            const examples = [
                { title: 'House Sketch', style: 'comic' },
                { title: 'Flower Drawing', style: 'watercolor' },
                { title: 'Portrait', style: 'stencil' },
                { title: 'Landscape', style: 'postcard' },
                { title: 'Abstract', style: 'funky' },
                { title: 'Tree', style: 'realistic' }
            ];
            
            const grid = document.getElementById('galleryGrid');
            let html = '';
            
            examples.forEach(ex => {
                const style = STYLES[ex.style];
                html += `
                    <div class="gallery-item">
                        <div class="gallery-item-image" style="background:linear-gradient(135deg, ${style.color}22, ${style.color}44);display:flex;align-items:center;justify-content:center;">
                            <span style="font-size:64px;opacity:0.5">${style.icon}</span>
                        </div>
                        <div class="gallery-item-info">
                            <div class="gallery-item-title">${ex.title}</div>
                            <div class="gallery-item-meta">${style.name} style</div>
                        </div>
                    </div>
                `;
            });
            
            grid.innerHTML = html;
        }
        
        // ============ NAVIGATION ============
        
        window.showSection = function(id) {
            document.querySelectorAll('.section').forEach(s => s.classList.remove('active'));
            document.getElementById('section-' + id).classList.add('active');
            document.querySelectorAll('.nav-pill').forEach(p => {
                p.classList.toggle('active', p.dataset.section === id);
            });
        };
        
        // ============ TOAST ============
        
        window.toast = function(msg, type = 'success') {
            const t = document.getElementById('toast');
            t.textContent = msg;
            t.className = 'toast ' + type;
            t.classList.add('show');
            setTimeout(() => t.classList.remove('show'), 3000);
        };
        
        // ============ RESIZE ============
        
        let resizeTimer;
        window.addEventListener('resize', () => {
            clearTimeout(resizeTimer);
            resizeTimer = setTimeout(() => {
                if (!hasDrawn) initCanvas();
            }, 250);
        });
    })();
    </script>
</body>
</html>
